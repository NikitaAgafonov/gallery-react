"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function getPages(e){for(var t=0,o=0;o<=Math.ceil(e.length/countImgPage)-1;o++){pages[o]=[];for(var s=0;s<countImgPage&&e[t];s++)pages[o].push(e[t]),t++}}var _createClass=function(){function e(e,t){for(var o=0;o<t.length;o++){var s=t[o];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,o,s){return o&&e(t.prototype,o),s&&e(t,s),t}}(),url="https://api-fotki.yandex.ru/api/top/?format=json",pages=[],countImgPage=8;jQuery.ajax({url:url,crossDomain:!0,contentType:"application/json",dataType:"jsonp"}).done(function(e){getPages(e.entries),ReactDOM.render(React.createElement(Photos,null),document.getElementById("main"))});var ImgPhotos=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return this.props.photo?React.createElement("img",{className:"thumbnail imgPhotos",onClick:this.props.onClick,src:this.props.photo.img.M.href}):null}}]),t}(React.Component),ImgSelectedPhoto=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this))}return _inherits(t,e),_createClass(t,[{key:"render",value:function(){return this.props.photo?React.createElement("div",{className:"popup"},React.createElement("div",{className:"popup__content"},React.createElement("div",{className:"popup__content_header"},React.createElement("div",{className:"popup__content_name"},this.props.photo.title),React.createElement("div",{className:"popup__content_close"},React.createElement("span",{className:"glyphicon glyphicon-remove-sign",onClick:this.props.close}))),React.createElement("div",{className:"popup__content_image"},React.createElement("img",{className:"left",src:"img/left_popup.png",onClick:this.props.prev}),React.createElement("img",{className:"thumbnail",src:this.props.photo.img.XL.href}),React.createElement("img",{className:"right",src:"img/right_popup.png",onClick:this.props.next})),React.createElement("div",{className:"popup__content_footer"},"Author: ",this.props.photo.author))):null}}]),t}(React.Component),Photos=function(e){function t(){_classCallCheck(this,t);var e=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.state={page:0,watchPhotos:[],selectedPhoto:{},selected:!1,selectedNum:0},window.addEventListener("keydown",e.userClick.bind(e)),e}return _inherits(t,e),_createClass(t,[{key:"userClick",value:function(e){this.state.selected?(37===e.keyCode&&this.prevPhoto(),39===e.keyCode&&this.nextPhoto()):(37===e.keyCode&&this.prevPage(),39===e.keyCode&&this.nextPage())}},{key:"renderImgPhotos",value:function(e){var t=this;return React.createElement(ImgPhotos,{page:this.state.page,photo:this.state.watchPhotos[e],numImg:e,onClick:function(){return t.selectUserPhoto(e)}})}},{key:"selectUserPhoto",value:function(e){this.setState({selectedPhoto:this.state.watchPhotos[e],selected:!0,selectedNum:e})}},{key:"renderImgPhoto",value:function(){var e=this;return this.state.selected?React.createElement(ImgSelectedPhoto,{photo:this.state.selectedPhoto,close:function(){return e.closePhoto()},next:function(){return e.nextPhoto()},prev:function(){return e.prevPhoto()}}):null}},{key:"closePhoto",value:function(){var e=this;$(".popup").animate({opacity:"0"},600,function(){e.setState({selectedPhoto:{},selected:!1}),$(this).css("opacity","1")})}},{key:"nextPhoto",value:function(){var e=this.state.selectedNum+1;return e>=this.state.watchPhotos.length?void this.closePhoto():void this.setState({selectedPhoto:this.state.watchPhotos[e],selectedNum:e})}},{key:"prevPhoto",value:function(){var e=this.state.selectedNum-1;return e<0?void this.closePhoto():void this.setState({selectedPhoto:this.state.watchPhotos[e],selectedNum:e})}},{key:"nextPage",value:function e(){for(var e=this.state.page+1,t=[],o=0;o<pages[e].length;o++)t.push(pages[e][o]);var s=this;$(".thumbnail").animate({opacity:"0"},600,function(){s.setState({page:e,watchPhotos:t}),$(this).animate({opacity:"1"},600)})}},{key:"prevPage",value:function e(){for(var e=this.state.page-1,t=[],o=0;o<pages[e].length;o++)t.push(pages[e][o]);var s=this;$(".thumbnail").animate({opacity:"0"},600,function(){s.setState({page:e,watchPhotos:t}),$(this).animate({opacity:"1"},600)})}},{key:"leftArrow",value:function(){var e=this;return 0===this.state.page?React.createElement("div",{className:"left"}):React.createElement("div",{className:"left"},React.createElement("img",{src:"img/left.png",onClick:function(){return e.prevPage()}}))}},{key:"rightArrow",value:function(){var e=this;return 6===this.state.page?React.createElement("div",{className:"right"}):React.createElement("div",{className:"right"},React.createElement("img",{src:"img/right.png",onClick:function(){return e.nextPage()}}))}},{key:"componentWillMount",value:function(){for(var e=[],t=0;t<pages[this.state.page].length;t++)e.push(pages[this.state.page][t]);this.setState({page:this.state.page,watchPhotos:e})}},{key:"render",value:function(){return React.createElement("div",{className:"photos"},this.leftArrow(),React.createElement("div",{className:"center"},this.renderImgPhotos(0),this.renderImgPhotos(1),this.renderImgPhotos(2),this.renderImgPhotos(3),this.renderImgPhotos(4),this.renderImgPhotos(5),this.renderImgPhotos(6),this.renderImgPhotos(7)),this.rightArrow(),this.renderImgPhoto())}}]),t}(React.Component);